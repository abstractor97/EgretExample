var egret;!function(e){var t;!function(t){var i="egret.BitmapData";e.registerClass(HTMLImageElement,i),e.registerClass(HTMLCanvasElement,i),e.registerClass(HTMLVideoElement,i)}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){function t(t){return t.hashCode=t.$hashCode=e.$hashCount++,t}e.$toBitmapData=t}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function e(){}var t=(__define,e);t.prototype;return e.call=function(e,t){},e.addCallback=function(e,t){},e}();t.WebExternalInterface=i,e.registerClass(i,"egret.web.WebExternalInterface",["egret.ExternalInterface"]),e.ExternalInterface=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i;!function(i){function n(e){return window.localStorage.getItem(e)}function r(t,i){try{return window.localStorage.setItem(t,i),!0}catch(n){return e.$warn(1018,t,i),!1}}function a(e){window.localStorage.removeItem(e)}function s(){window.localStorage.clear()}t.getItem=n,t.setItem=r,t.removeItem=a,t.clear=s}(i=t.web||(t.web={}))}(t=e.localStorage||(e.localStorage={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(){i.call(this),this.loaded=!1}__extends(n,i);var r=__define,a=n,s=a.prototype;return r(s,"length",function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")}),s.load=function(t){function i(){a(),h.indexOf("firefox")>=0&&(o.pause(),o.muted=!1),s.loaded=!0,s.dispatchEventWith(e.Event.COMPLETE)}function r(){a(),s.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}function a(){o.removeEventListener("canplaythrough",i),o.removeEventListener("error",r)}var s=this;this.url=t;var o=new Audio(t);o.addEventListener("canplaythrough",i),o.addEventListener("error",r);var h=navigator.userAgent.toLowerCase();h.indexOf("firefox")>=0&&(o.autoplay=!0,o.muted=!0),o.load(),this.originAudio=o,n.$recycle(this.url,o)},s.play=function(i,r){i=+i||0,r=+r||0;var a=n.$pop(this.url);null==a&&(a=this.originAudio.cloneNode()),a.autoplay=!0;var s=new t.HtmlSoundChannel(a);return s.$url=this.url,s.$loops=r,s.$startTime=i,s.$play(),e.sys.$pushSoundChannel(s),s},s.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),n.$clear(this.url)},n.$clear=function(e){var t=n.audios[e];t&&(t.length=0)},n.$pop=function(e){var t=n.audios[e];return t&&t.length>0?t.pop():null},n.$recycle=function(e,t){var i=n.audios[e];null==n.audios[e]&&(i=n.audios[e]=[]),i.push(t)},n.MUSIC="music",n.EFFECT="effect",n.audios={},n}(e.EventDispatcher);t.HtmlSound=i,e.registerClass(i,"egret.web.HtmlSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(t){var n=this;i.call(this),this.$startTime=0,this.audio=null,this.isStopped=!1,this.canPlay=function(){n.audio.removeEventListener("canplay",n.canPlay);try{n.audio.currentTime=n.$startTime}catch(e){}finally{n.audio.play()}},this.onPlayEnd=function(){return 1==n.$loops?(n.stop(),void n.dispatchEventWith(e.Event.SOUND_COMPLETE)):(n.$loops>0&&n.$loops--,void n.$play())},t.addEventListener("ended",this.onPlayEnd),this.audio=t}__extends(n,i);var r=__define,a=n,s=a.prototype;return s.$play=function(){if(this.isStopped)return void e.$error(1036);try{this.audio.currentTime=this.$startTime}catch(t){return void this.audio.addEventListener("canplay",this.canPlay)}this.audio.play()},s.stop=function(){if(this.audio){this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0;var i=this.audio;i.pause(),i.removeEventListener("ended",this.onPlayEnd),this.audio=null,t.HtmlSound.$recycle(this.$url,i)}},r(s,"volume",function(){return this.audio?this.audio.volume:1},function(t){return this.isStopped?void e.$error(1036):void(this.audio&&(this.audio.volume=t))}),r(s,"position",function(){return this.audio?this.audio.currentTime:0}),n}(e.EventDispatcher);t.HtmlSoundChannel=i,e.registerClass(i,"egret.web.HtmlSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(){i.call(this),this.loaded=!1}__extends(n,i);var r=__define,a=n,s=a.prototype;return s.load=function(i){var n=this;this.url=i,QZAppExternal.preloadSound(function(t){0==t.code?(n.loaded=!0,n.dispatchEventWith(e.Event.COMPLETE)):n.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},{bid:-1,url:t.Html5Capatibility._QQRootPath+i,refresh:1})},r(s,"length",function(){throw new Error("qq sound not supported!")}),s.play=function(i,n){i=+i||0,n=+n||0;var r=new t.QQSoundChannel;return r.$url=this.url,r.$loops=n,r.$type=this.type,r.$startTime=i,r.$play(),e.sys.$pushSoundChannel(r),r},s.close=function(){},n.MUSIC="music",n.EFFECT="effect",n}(e.EventDispatcher);t.QQSound=i,e.registerClass(i,"egret.web.QQSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(){var i=this;t.call(this),this.$startTime=0,this.isStopped=!1,this.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(e.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},this._startTime=0}__extends(i,t);var n=__define,r=i,a=r.prototype;return a.$play=function(){if(this.isStopped)return void e.$error(1036);var t=this;this._startTime=Date.now();var i=0;i=t.$loops>0?t.$loops-1:-1,this.$type==e.Sound.EFFECT?QZAppExternal.playLocalSound(function(e){},{bid:-1,url:t.$url,loop:i}):QZAppExternal.playLocalBackSound(function(e){},{bid:-1,url:t.$url,loop:i})},a.stop=function(){this.$type==e.Sound.EFFECT?QZAppExternal.stopSound():QZAppExternal.stopBackSound(),this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0},n(a,"volume",function(){return 1},function(t){return this.isStopped?void e.$error(1036):void 0}),n(a,"position",function(){return(Date.now()-this._startTime)/1e3}),i}(e.EventDispatcher);t.QQSoundChannel=i,e.registerClass(i,"egret.web.QQSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function e(){}var t=(__define,e);t.prototype;return e.decodeAudios=function(){if(!(e.decodeArr.length<=0||e.isDecoding)){e.isDecoding=!0;var t=e.decodeArr.shift();e.ctx.decodeAudioData(t.buffer,function(i){t.self.audioBuffer=i,t.success&&t.success(),e.isDecoding=!1,e.decodeAudios()},function(){alert("sound decode error: "+t.url+"！\nsee http://edn.egret.com/cn/docs/page/156"),t.fail&&t.fail(),e.isDecoding=!1,e.decodeAudios()})}},e.canUseWebAudio=window.AudioContext||window.webkitAudioContext||window.mozAudioContext,e.ctx=e.canUseWebAudio?new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext):void 0,e.decodeArr=[],e.isDecoding=!1,e}();t.WebAudioDecode=i,e.registerClass(i,"egret.web.WebAudioDecode");var n=function(n){function r(){n.call(this),this.loaded=!1}__extends(r,n);var a=__define,s=r,o=s.prototype;return a(o,"length",function(){if(this.audioBuffer)return this.audioBuffer.duration;throw new Error("sound not loaded!")}),o.load=function(t){function n(){a.loaded=!0,a.dispatchEventWith(e.Event.COMPLETE)}function r(){a.dispatchEventWith(e.IOErrorEvent.IO_ERROR)}var a=this;this.url=t;var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",console.log("loadWebAudio"),s.onload=function(){a._arrayBuffer=s.response,i.decodeArr.push({buffer:a._arrayBuffer,success:n,fail:r,self:a,url:a.url}),i.decodeAudios()},s.send()},o.play=function(i,n){i=+i||0,n=+n||0;var r=new t.WebAudioSoundChannel;return r.$url=this.url,r.$loops=n,r.$audioBuffer=this.audioBuffer,r.$startTime=i,r.$play(),e.sys.$pushSoundChannel(r),r},o.close=function(){},r.MUSIC="music",r.EFFECT="effect",r}(e.EventDispatcher);t.WebAudioSound=n,e.registerClass(n,"egret.web.WebAudioSound",["egret.Sound"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(){var n=this;i.call(this),this.$startTime=0,this.bufferSource=null,this.context=t.WebAudioDecode.ctx,this.isStopped=!1,this._currentTime=0,this._volume=1,this.onPlayEnd=function(){return 1==n.$loops?(n.stop(),void n.dispatchEventWith(e.Event.SOUND_COMPLETE)):(n.$loops>0&&n.$loops--,void n.$play())},this._startTime=0,this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}__extends(n,i);var r=__define,a=n,s=a.prototype;return s.$play=function(){if(this.isStopped)return void e.$error(1036);this.bufferSource&&(this.bufferSource.onended=null,this.bufferSource=null);var t=this.context,i=this.gain,n=t.createBufferSource();this.bufferSource=n,n.buffer=this.$audioBuffer,n.connect(i),i.connect(t.destination),n.onended=this.onPlayEnd,this._startTime=Date.now(),this.gain.gain.value=this._volume,n.start(0,this.$startTime),this._currentTime=0},s.stop=function(){if(this.bufferSource){var t=this.bufferSource;t.stop?t.stop(0):t.noteOff(0),this.bufferSource.disconnect(),this.bufferSource=null,this.$audioBuffer=null}this.isStopped||e.sys.$popSoundChannel(this),this.isStopped=!0},r(s,"volume",function(){return this._volume},function(t){return this.isStopped?void e.$error(1036):(this._volume=t,void(this.gain.gain.value=t))}),r(s,"position",function(){return this.bufferSource?(Date.now()-this._startTime)/1e3+this.$startTime:0}),n}(e.EventDispatcher);t.WebAudioSoundChannel=i,e.registerClass(i,"egret.web.WebAudioSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(i){var n=this;t.call(this),this.loaded=!1,this.closed=!1,this.heightSet=0/0,this.widthSet=0/0,this.isPlayed=!1,this.screenChanged=function(e){var t=!!n.video.webkitDisplayingFullscreen;t||n.checkFullScreen(!1)},this._fullscreen=!0,this.onVideoLoaded=function(){n.video.removeEventListener("canplay",n.onVideoLoaded);var t=n.video;n.loaded=!0,t.pause(),n.posterData&&(n.posterData.width=n.getPlayWidth(),n.posterData.height=n.getPlayHeight()),t.width=t.videoWidth,t.height=t.videoHeight,n.$invalidateContentBounds(),n.dispatchEventWith(e.Event.COMPLETE)},this.$renderNode=new e.sys.BitmapNode,this.src=i,this.once(e.Event.ADDED_TO_STAGE,this.loadPoster,this),i&&this.load()}__extends(i,t);var n=__define,r=i,a=r.prototype;return a.load=function(e){var t=this;if(e=e||this.src,this.src=e,!this.video||this.video.src!=e){var i=document.createElement("video");i.controls=null,i.src=e,i.setAttribute("autoplay","autoplay"),i.setAttribute("webkit-playsinline","true"),i.addEventListener("canplay",this.onVideoLoaded),i.addEventListener("error",function(){return t.onVideoError()}),i.addEventListener("ended",function(){return t.onVideoEnded()}),i.load(),i.play(),i.style.position="absolute",i.style.top="0px",i.style.zIndex="-88888",i.style.left="0px",i.height=1,i.width=1,window.setTimeout(function(){return i.pause()},16),this.video=i}},a.play=function(t,i){var n=this;if(void 0===i&&(i=!1),0==this.loaded)return this.load(this.src),void this.once(e.Event.COMPLETE,function(e){return n.play(t,i)},this);this.isPlayed=!0;var r=this.video;void 0!=t&&(r.currentTime=+t||0),r.loop=!!i,e.Capabilities.isMobile?r.style.zIndex="-88888":r.style.zIndex="9999",r.style.position="absolute",r.style.top="0px",r.style.left="0px",r.height=this.heightSet,r.width=this.widthSet,"Windows PC"!=e.Capabilities.os&&"Mac OS"!=e.Capabilities.os&&setTimeout(function(){r.width=0},1e3),this.checkFullScreen(this._fullscreen)},a.checkFullScreen=function(t){var i=this.video;t?(null==i.parentElement&&(i.removeAttribute("webkit-playsinline"),document.body.appendChild(i)),e.stopTick(this.markDirty,this),this.goFullscreen()):(null!=i.parentElement&&i.parentElement.removeChild(i),i.setAttribute("webkit-playsinline","true"),this.setFullScreenMonitor(!1),e.startTick(this.markDirty,this)),i.play()},a.goFullscreen=function(){var t,i=this.video;return t=e.web.getPrefixStyleName("requestFullscreen",i),i[t]||(t=e.web.getPrefixStyleName("requestFullScreen",i),i[t])?(i.removeAttribute("webkit-playsinline"),i[t](),this.setFullScreenMonitor(!0),!0):!0},a.setFullScreenMonitor=function(e){var t=this.video;e?(t.addEventListener("mozfullscreenchange",this.screenChanged),t.addEventListener("webkitfullscreenchange",this.screenChanged),t.addEventListener("webkitfullscreenerror",this.screenError),t.addEventListener("webkitfullscreenerror",this.screenError)):(t.removeEventListener("mozfullscreenchange",this.screenChanged),t.removeEventListener("webkitfullscreenchange",this.screenChanged),t.removeEventListener("webkitfullscreenerror",this.screenError),t.removeEventListener("webkitfullscreenerror",this.screenError))},a.screenError=function(){e.$error(3003)},a.exitFullscreen=function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.oCancelFullScreen?document.oCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},a.onVideoEnded=function(){this.pause(),this.isPlayed=!1,this.$invalidateContentBounds(),this.dispatchEventWith(e.Event.ENDED)},a.onVideoError=function(){this.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},a.close=function(){var e=this;this.closed=!0,this.video.removeEventListener("canplay",this.onVideoLoaded),this.video.removeEventListener("error",function(){return e.onVideoError()}),this.video.removeEventListener("ended",function(){return e.onVideoEnded()}),this.pause(),0==this.loaded&&this.video&&(this.video.src=""),this.video&&this.video.parentElement&&(this.video.parentElement.removeChild(this.video),this.video=null),this.loaded=!1},a.pause=function(){this.video&&this.video.pause(),e.stopTick(this.markDirty,this),this.$invalidate()},n(a,"volume",function(){return this.video?this.video.volume:1},function(e){this.video&&(this.video.volume=e)}),n(a,"position",function(){return this.video?this.video.currentTime:0},function(e){this.video&&(this.video.currentTime=e)}),n(a,"fullscreen",function(){return this._fullscreen},function(t){e.Capabilities.isMobile||(this._fullscreen=!!t,this.video&&0==this.video.paused&&this.checkFullScreen(this._fullscreen))}),n(a,"bitmapData",function(){return this.video&&this.loaded?(this._bitmapData||(this.video.width=this.video.videoWidth,this.video.height=this.video.videoHeight,this._bitmapData=e.$toBitmapData(this.video)),this._bitmapData):null}),a.loadPoster=function(){var t=this,i=this.poster;if(i){var n=new e.ImageLoader;n.once(e.Event.COMPLETE,function(e){n.data;t.posterData=n.data,t.posterData.width=t.getPlayWidth(),t.posterData.height=t.getPlayHeight(),t.$invalidateContentBounds()},this),n.load(i)}},a.$measureContentBounds=function(e){var t=this.bitmapData,i=this.posterData;t?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?e.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):e.setEmpty()},a.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},a.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},a.$render=function(){var t=this.$renderNode,i=this.bitmapData,n=this.posterData,r=this.getPlayWidth(),a=this.getPlayHeight();this.isPlayed&&!e.Capabilities.isMobile||!n?this.isPlayed&&i&&(t.image=i,t.drawImage(0,0,i.width,i.height,0,0,r,a)):(t.image=n,t.drawImage(0,0,n.width,n.height,0,0,r,a))},a.markDirty=function(){return this.$invalidate(),!0},a.$setHeight=function(e){return this.heightSet=+e||0,t.prototype.$setHeight.call(this,e)},a.$setWidth=function(e){return this.widthSet=+e||0,t.prototype.$setWidth.call(this,e)},n(a,"paused",function(){return this.video?this.video.paused:!0}),i}(e.DisplayObject);t.WebVideo=i,e.registerClass(i,"egret.web.WebVideo",["egret.Video"]),e.Video=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(){t.call(this),this._url="",this._method=""}__extends(i,t);var n=__define,r=i,a=r.prototype;return n(a,"response",function(){return this._xhr?void 0!=this._xhr.response?this._xhr.response:"text"==this._responseType?this._xhr.responseText:"document"==this._responseType?this._xhr.responseXML:null:null}),n(a,"responseType",function(){return this._responseType},function(e){this._responseType=e}),n(a,"withCredentials",function(){return this._withCredentials},function(e){this._withCredentials=e}),a.getXHR=function(){return window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP")},a.open=function(e,t){void 0===t&&(t="GET"),this._url=e,this._method=t,this._xhr&&(this._xhr.abort(),this._xhr=null),this._xhr=this.getXHR(),this._xhr.onreadystatechange=this.onReadyStateChange.bind(this),this._xhr.onprogress=this.updateProgress.bind(this),this._xhr.open(this._method,this._url,!0)},a.send=function(e){if(null!=this._responseType&&(this._xhr.responseType=this._responseType),null!=this._withCredentials&&(this._xhr.withCredentials=this._withCredentials),this.headerObj)for(var t in this.headerObj)this._xhr.setRequestHeader(t,this.headerObj[t]);this._xhr.send(e)},a.abort=function(){this._xhr&&this._xhr.abort()},a.getAllResponseHeaders=function(){if(!this._xhr)return null;var e=this._xhr.getAllResponseHeaders();return e?e:""},a.setRequestHeader=function(e,t){this.headerObj||(this.headerObj={}),this.headerObj[e]=t},a.getResponseHeader=function(e){if(!this._xhr)return null;var t=this._xhr.getResponseHeader(e);return t?t:""},a.onReadyStateChange=function(){var t=this._xhr;if(4==t.readyState){var i=t.status>=400||0==t.status,n=(this._url,this);window.setTimeout(function(){i?n.dispatchEventWith(e.IOErrorEvent.IO_ERROR):n.dispatchEventWith(e.Event.COMPLETE)},0)}},a.updateProgress=function(t){t.lengthComputable&&e.ProgressEvent.dispatchProgressEvent(this,e.ProgressEvent.PROGRESS,t.loaded,t.total)},i}(e.EventDispatcher);t.WebHttpRequest=i,e.registerClass(i,"egret.web.WebHttpRequest",["egret.HttpRequest"]),e.HttpRequest=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=window.URL||window.webkitURL,n=function(n){function r(){n.apply(this,arguments),this.data=null,this._crossOrigin=null,this._hasCrossOriginSet=!1,this.currentImage=null,this.request=null}__extends(r,n);var a=__define,s=r,o=s.prototype;return a(o,"crossOrigin",function(){return this._crossOrigin},function(e){this._hasCrossOriginSet=!0,this._crossOrigin=e}),o.load=function(i){if(t.Html5Capatibility._canUseBlob&&0!=i.indexOf("wxLocalResource:")&&0!=i.indexOf("data:")&&0!=i.indexOf("http:")&&0!=i.indexOf("https:")){var n=this.request;n||(n=this.request=new e.web.WebHttpRequest,n.addEventListener(e.Event.COMPLETE,this.onBlobLoaded,this),n.addEventListener(e.IOErrorEvent.IO_ERROR,this.onBlobError,this),n.responseType="blob"),n.open(i),n.send()}else this.loadImage(i)},o.onBlobLoaded=function(e){var t=this.request.response;this.loadImage(i.createObjectURL(t))},o.onBlobError=function(e){this.dispatchIOError(this.currentURL)},o.loadImage=function(e){var t=new Image;this.data=null,this.currentImage=t,this._hasCrossOriginSet?this._crossOrigin&&(t.crossOrigin=this._crossOrigin):r.crossOrigin&&(t.crossOrigin=r.crossOrigin),t.onload=this.onImageComplete.bind(this),t.onerror=this.onLoadError.bind(this),t.src=e},o.onImageComplete=function(t){var i=this.getImage(t);if(i){this.data=e.$toBitmapData(i);var n=this;window.setTimeout(function(){n.dispatchEventWith(e.Event.COMPLETE)},0)}},o.onLoadError=function(e){var t=this.getImage(e);t&&this.dispatchIOError(t.src)},o.dispatchIOError=function(t){var i=this;window.setTimeout(function(){i.dispatchEventWith(e.IOErrorEvent.IO_ERROR)},0)},o.getImage=function(t){var n=t.target,r=n.src;if(0==r.indexOf("blob:"))try{i.revokeObjectURL(n.src)}catch(a){e.$warn(1037)}return n.onerror=null,n.onload=null,this.currentImage!==n?null:(this.currentImage=null,n)},r.crossOrigin=null,r}(e.EventDispatcher);t.WebImageLoader=n,e.registerClass(n,"egret.web.WebImageLoader",["egret.ImageLoader"]),e.ImageLoader=n}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(){i.call(this),this._isNeedShow=!1,this.inputElement=null,this.inputDiv=null,this._gscaleX=0,this._gscaleY=0,this._isNeesHide=!1,this.textValue="",this.colorValue=16777215,this._styleInfoes={}}__extends(n,i);var r=(__define,n),a=r.prototype;return a.$setTextField=function(e){return this.$textfield=e,!0},a.$addToStage=function(){this.htmlInput=e.web.$getTextAdapter(this.$textfield)},a._initElement=function(){var e=this.$textfield.localToGlobal(0,0),t=e.x,i=e.y,n=this.$textfield.$renderNode.renderMatrix,r=n.a,a=n.d,s=this.htmlInput.$scaleX,o=this.htmlInput.$scaleY;this.inputDiv.style.left=t*s+"px",this.inputDiv.style.top=i*o+"px",this.$textfield.multiline&&this.$textfield.height>this.$textfield.size?(this.inputDiv.style.top=i*o+"px",this.inputElement.style.top=-this.$textfield.lineSpacing/2*o+"px"):(this.inputDiv.style.top=i*o+"px",this.inputElement.style.top="0px"),this._gscaleX=s*r,this._gscaleY=o*a},a.$show=function(){this.htmlInput.isCurrentStageText(this)?this.inputElement.onblur=null:(this.inputElement=this.htmlInput.getInputElement(this),this.inputDiv=this.htmlInput._inputDIV),this.htmlInput._needShow=!0,this._isNeedShow=!0,this._initElement()},a.onBlurHandler=function(){this.htmlInput.clearInputElement(),window.scrollTo(0,0)},a.executeShow=function(){this.inputElement.value=this.$getText(),null==this.inputElement.onblur&&(this.inputElement.onblur=this.onBlurHandler.bind(this)),this.$resetStageText(),this.$textfield.maxChars>0?this.inputElement.setAttribute("maxlength",this.$textfield.maxChars):this.inputElement.removeAttribute("maxlength"),this.inputElement.selectionStart=this.inputElement.value.length,this.inputElement.selectionEnd=this.inputElement.value.length,this.inputElement.focus()},a.$hide=function(){this._isNeesHide=!0,this.htmlInput&&e.web.Html5Capatibility._System_OS==e.web.SystemOSType.IOS&&this.htmlInput.disconnectStageText(this)},a.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},a.$setText=function(e){return this.textValue=e,this.resetText(),!0},a.resetText=function(){this.inputElement&&(this.inputElement.value=this.textValue)},a.$setColor=function(e){return this.colorValue=e,this.resetColor(),!0},a.resetColor=function(){this.inputElement&&this.setElementStyle("color",e.toColorString(this.colorValue))},a.$onBlur=function(){t.Html5Capatibility._System_OS==t.SystemOSType.WPHONE&&e.Event.dispatchEvent(this,"updateText",!1)},a._onInput=function(){var i=this;if(t.Html5Capatibility._System_OS==t.SystemOSType.WPHONE){var n=this.$textfield.$TextField;null==n[35]&&null==n[36]?(i.textValue=i.inputElement.value,e.Event.dispatchEvent(i,"updateText",!1)):window.setTimeout(function(){i.inputElement&&i.inputElement.selectionStart&&i.inputElement.selectionEnd&&i.inputElement.selectionStart==i.inputElement.selectionEnd&&(i.textValue=i.inputElement.value,e.Event.dispatchEvent(i,"updateText",!1))},0)}else window.setTimeout(function(){i.inputElement.selectionStart==i.inputElement.selectionEnd&&(i.textValue=i.inputElement.value,e.Event.dispatchEvent(i,"updateText",!1))},0)},a.setAreaHeight=function(){var t=this.$textfield;if(t.multiline){var i=e.TextFieldUtils.$getTextHeight(t);if(t.height<=t.size||t.height<i)this.setElementStyle("height",t.size*this._gscaleY+"px"),this.setElementStyle("padding","0px"),this.setElementStyle("lineHeight",t.size*this._gscaleY+"px");else{this.setElementStyle("height",(i+t.lineSpacing)*this._gscaleY+"px");var n=(t.height-i)*this._gscaleY,r=e.TextFieldUtils.$getValign(t),a=n*r,s=n-a;this.setElementStyle("padding",a+"px 0px "+s+"px 0px"),this.setElementStyle("lineHeight",(t.size+t.lineSpacing)*this._gscaleY+"px")}}},a._onClickHandler=function(t){this._isNeedShow&&(t.stopImmediatePropagation(),this._isNeedShow=!1,this.executeShow(),this.dispatchEvent(new e.Event("focus")))},a._onDisconnect=function(){this.inputElement=null,this.dispatchEvent(new e.Event("blur"))},a.setElementStyle=function(e,t){this.inputElement&&this._styleInfoes[e]!=t&&(this.inputElement.style[e]=t)},a.$removeFromStage=function(){this.inputElement&&this.htmlInput.disconnectStageText(this)},a.$resetStageText=function(){if(this.inputElement){var t=this.$textfield;if(this.setElementStyle("fontFamily",t.fontFamily),this.setElementStyle("fontStyle",t.italic?"italic":"normal"),this.setElementStyle("fontWeight",t.bold?"bold":"normal"),this.setElementStyle("textAlign",t.textAlign),this.setElementStyle("fontSize",t.size*this._gscaleY+"px"),this.setElementStyle("color",e.toColorString(t.textColor)),t.stage){var i=t.localToGlobal(0,0).x;i=Math.min(t.width,t.stage.stageWidth-i)}else i=t.width;if(this.setElementStyle("width",i*this._gscaleX+"px"),this.setElementStyle("verticalAlign",t.verticalAlign),t.multiline)this.setAreaHeight();else if(this.setElementStyle("lineHeight",t.size*this._gscaleY+"px"),t.height<t.size){this.setElementStyle("height",t.size*this._gscaleY+"px");var n=t.size/2*this._gscaleY;this.setElementStyle("padding","0px 0px "+n+"px 0px")}else{this.setElementStyle("height",t.size*this._gscaleY+"px");var r=(t.height-t.size)*this._gscaleY,a=e.TextFieldUtils.$getValign(t),s=r*a,n=r-s;n<t.size/2*this._gscaleY&&(n=t.size/2*this._gscaleY),this.setElementStyle("padding",s+"px 0px "+n+"px 0px")}this.inputDiv.style.clip="rect(0px "+t.width*this._gscaleX+"px "+t.height*this._gscaleY+"px 0px)",this.inputDiv.style.height=t.height*this._gscaleY+"px",this.inputDiv.style.width=i*this._gscaleX+"px"}},n}(e.EventDispatcher);t.HTML5StageText=i,e.registerClass(i,"egret.web.HTML5StageText",["egret.StageText"]),e.StageText=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function t(){this._needShow=!1,this.$scaleX=1,this.$scaleY=1}var i=(__define,t),n=i.prototype;return n.isInputOn=function(){return null!=this._stageText},n.isCurrentStageText=function(e){return this._stageText==e},n.initValue=function(e){e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.border="none",e.style.padding="0"},n.$updateSize=function(){if(this.canvas){var t=this.canvas.width,i=this.canvas.height,n=this.canvas.style.width.split("px")[0],r=this.canvas.style.height.split("px")[0];this.$scaleX=n/t,this.$scaleY=r/i,this.StageDelegateDiv.style.left=this.canvas.style.left,this.StageDelegateDiv.style.top=this.canvas.style.top;var a=e.web.getPrefixStyleName("transform");this.StageDelegateDiv.style[a]=this.canvas.style[a],this.StageDelegateDiv.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px"}},n._initStageDelegateDiv=function(t,i){this.canvas=i;var n,r=this;n||(n=document.createElement("div"),this.StageDelegateDiv=n,n.id="StageDelegateDiv",t.appendChild(n),r.initValue(n),r._inputDIV=document.createElement("div"),r.initValue(r._inputDIV),r._inputDIV.style.width="0px",r._inputDIV.style.height="0px",r._inputDIV.style.left="0px",r._inputDIV.style.top="-100px",r._inputDIV.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",n.appendChild(r._inputDIV),this.canvas.addEventListener("click",function(e){r._needShow?(r._needShow=!1,r._stageText._onClickHandler(e),r.show()):r._inputElement&&(r.clearInputElement(),r._inputElement.blur(),r._inputElement=null)}),r.initInputElement(!0),r.initInputElement(!1))},n.initInputElement=function(e){var t,i=this;e?(t=document.createElement("textarea"),t.style.resize="none",i._multiElement=t,t.id="egretTextarea"):(t=document.createElement("input"),i._simpleElement=t,t.id="egretInput"),t.type="text",i._inputDIV.appendChild(t),t.setAttribute("tabindex","-1"),t.style.width="1px",t.style.height="12px",i.initValue(t),t.style.outline="thin",t.style.background="none",t.style.overflow="hidden",t.style.wordBreak="break-all",t.style.opacity=0,t.oninput=function(){i._stageText&&i._stageText._onInput()}},n.show=function(){var t=this,i=t._inputElement;e.$callAsync(function(){i.style.opacity=1},t)},n.disconnectStageText=function(e){(null==this._stageText||this._stageText==e)&&(this.clearInputElement(),this._inputElement&&this._inputElement.blur())},n.clearInputElement=function(){var e=this;if(e._inputElement){e._inputElement.value="",e._inputElement.onblur=null,e._inputElement.style.width="1px",e._inputElement.style.height="12px",e._inputElement.style.left="0px",e._inputElement.style.top="0px",e._inputElement.style.opacity=0;var t;t=e._simpleElement==e._inputElement?e._multiElement:e._simpleElement,t.style.display="block",e._inputDIV.style.left="0px",e._inputDIV.style.top="-100px",e._inputDIV.style.height="0px",e._inputDIV.style.width="0px"}e._stageText&&(e._stageText._onDisconnect(),e._stageText=null,this.canvas.userTyping=!1)},n.getInputElement=function(e){var t=this;t.clearInputElement(),t._stageText=e,this.canvas.userTyping=!0,t._stageText.$textfield.multiline?t._inputElement=t._multiElement:t._inputElement=t._simpleElement;var i;return i=t._simpleElement==t._inputElement?t._multiElement:t._simpleElement,i.style.display="none",t._inputElement},t}();t.HTMLInput=i,e.registerClass(i,"egret.web.HTMLInput")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){function t(e){var t=e.stage?e.stage.$hashCode:0,i=n[t],s=r[t],o=a[t];return s&&o&&(delete r[t],delete a[t]),i}function i(e,t,i,s){e._initStageDelegateDiv(i,s),n[t.$hashCode]=e,r[t.$hashCode]=s,a[t.$hashCode]=i}var n={},r={},a={};e.$getTextAdapter=t,e.$cacheTextAdapter=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(e,t,i,n,s){var o="";s&&(o+="italic "),n&&(o+="bold "),o+=(i||12)+"px ",o+=t||"Arial";var h=0,l=a[o]||(a[o]={});r.font=o;for(var u=e.length,c=0;u>c;c++){var d=e.charCodeAt(c),f=l[d]||(l[d]=r.measureText(e.charAt(c)).width);h+=f}return h}function n(){var e=document.createElement("canvas");r=e.getContext("2d"),r.textAlign="left",r.textBaseline="middle"}var r=null,a={};n(),e.sys.measureText=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(t,i){var n=document.createElement("canvas");isNaN(t)||isNaN(i)||(n.width=t,n.height=i),e.$toBitmapData(n);var r=n.getContext("2d");if(void 0===r.imageSmoothingEnabled){for(var a=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=a.length-1;s>=0;s--){var o=a[s];if(void 0!==r[o])break}try{Object.defineProperty(r,"imageSmoothingEnabled",{get:function(){return this[o]},set:function(e){this[o]=e}})}catch(h){r.imageSmoothingEnabled=r[o]}}return n}var n=i(),r=function(){function e(e,t){this.surface=i(e,t),this.context=this.surface.getContext("2d")}var t=__define,r=e,a=r.prototype;return t(a,"width",function(){return this.surface.width}),t(a,"height",function(){return this.surface.height}),a.resize=function(e,t,i){var n=this.surface;if(i){var r=!1;n.width<e&&(n.width=e,r=!0),n.height<t&&(n.height=t,r=!0),r||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else n.width!=e&&(n.width=e),n.height!=t&&(n.height=t);this.clear()},a.resizeTo=function(e,t,i,r){var a=(this.context,this.surface),s=n,o=s.getContext("2d");n=a,this.context=o,this.surface=s,s.width=Math.max(e,257),s.height=Math.max(t,257),o.setTransform(1,0,0,1,0,0),o.drawImage(a,i,r),a.height=1,a.width=1},a.beginClip=function(e,t,i){t=+t||0,i=+i||0;var n=this.context;n.save(),n.beginPath(),n.setTransform(1,0,0,1,t,i);for(var r=e.length,a=0;r>a;a++){var s=e[a];n.clearRect(s.minX,s.minY,s.width,s.height),n.rect(s.minX,s.minY,s.width,s.height)}n.clip()},a.endClip=function(){this.context.restore()},a.getPixel=function(e,t){return this.context.getImageData(e,t,1,1).data},a.toDataURL=function(e,t){return this.surface.toDataURL(e,t)},a.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},a.destroy=function(){this.surface.width=this.surface.height=0},e
}();t.CanvasRenderBuffer=r,e.registerClass(r,"egret.web.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(i,n){var r=this;t.call(this),this.onTouchBegin=function(e){var t=r.getLocation(e);r.touch.onTouchBegin(t.x,t.y,e.identifier)},this.onTouchMove=function(e){var t=r.getLocation(e);r.touch.onTouchMove(t.x,t.y,e.identifier)},this.onTouchEnd=function(e){var t=r.getLocation(e);r.touch.onTouchEnd(t.x,t.y,e.identifier)},this.scaleX=1,this.scaleY=1,this.rotation=0,this.canvas=n,this.touch=new e.sys.TouchHandler(i),this.addListeners()}__extends(i,t);var n=(__define,i),r=n.prototype;return r.addListeners=function(){var t=this;window.navigator.msPointerEnabled?(this.canvas.addEventListener("MSPointerDown",function(e){e.identifier=e.pointerId,t.onTouchBegin(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerMove",function(e){e.identifier=e.pointerId,t.onTouchMove(e),t.prevent(e)},!1),this.canvas.addEventListener("MSPointerUp",function(e){e.identifier=e.pointerId,t.onTouchEnd(e),t.prevent(e)},!1)):(e.Capabilities.$isMobile||this.addMouseListener(),this.addTouchListener())},r.addMouseListener=function(){this.canvas.addEventListener("mousedown",this.onTouchBegin),this.canvas.addEventListener("mousemove",this.onTouchMove),this.canvas.addEventListener("mouseup",this.onTouchEnd)},r.addTouchListener=function(){var e=this;this.canvas.addEventListener("touchstart",function(t){for(var i=t.changedTouches.length,n=0;i>n;n++)e.onTouchBegin(t.changedTouches[n]);e.prevent(t)},!1),this.canvas.addEventListener("touchmove",function(t){for(var i=t.changedTouches.length,n=0;i>n;n++)e.onTouchMove(t.changedTouches[n]);e.prevent(t)},!1),this.canvas.addEventListener("touchend",function(t){for(var i=t.changedTouches.length,n=0;i>n;n++)e.onTouchEnd(t.changedTouches[n]);e.prevent(t)},!1),this.canvas.addEventListener("touchcancel",function(t){for(var i=t.changedTouches.length,n=0;i>n;n++)e.onTouchEnd(t.changedTouches[n]);e.prevent(t)},!1)},r.prevent=function(e){e.stopPropagation(),1==e.isScroll||this.canvas.userTyping||e.preventDefault()},r.getLocation=function(t){t.identifier=+t.identifier||0;var i=document.documentElement,n=this.canvas.getBoundingClientRect(),r=n.left+window.pageXOffset-i.clientLeft,a=n.top+window.pageYOffset-i.clientTop,s=t.pageX-r,o=s,h=t.pageY-a,l=h;return 90==this.rotation?(o=h,l=n.width-s):-90==this.rotation&&(o=n.height-h,l=s),o/=this.scaleX,l/=this.scaleY,e.$TempPoint.setTo(Math.round(o),Math.round(l))},r.updateScaleMode=function(e,t,i){this.scaleX=e,this.scaleY=t,this.rotation=i},r.$updateMaxTouches=function(){this.touch.$initMaxTouches()},i}(e.HashObject);t.WebTouchHandler=i,e.registerClass(i,"egret.web.WebTouchHandler")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(e){t.call(this),this.isActivate=!0,this.stage=e,this.registerListener()}__extends(i,t);var n=(__define,i),r=n.prototype;return r.registerListener=function(){var t=this,i=function(){t.isActivate&&(t.isActivate=!1,t.stage.dispatchEvent(new e.Event(e.Event.DEACTIVATE)))},n=function(){t.isActivate||(t.isActivate=!0,t.stage.dispatchEvent(new e.Event(e.Event.ACTIVATE)))},r=function(){document[a]?i():n()};window.addEventListener("focus",n,!1),window.addEventListener("blur",i,!1);var a,s;"undefined"!=typeof document.hidden?(a="hidden",s="visibilitychange"):"undefined"!=typeof document.mozHidden?(a="mozHidden",s="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(a="msHidden",s="msvisibilitychange"):"undefined"!=typeof document.webkitHidden?(a="webkitHidden",s="webkitvisibilitychange"):"undefined"!=typeof document.oHidden&&(a="oHidden",s="ovisibilitychange"),"onpageshow"in window&&"onpagehide"in window&&(window.addEventListener("pageshow",n,!1),window.addEventListener("pagehide",i,!1)),a&&s&&document.addEventListener(s,r,!1);var o=navigator.userAgent,h=/micromessenger/gi.test(o),l=/mqq/gi.test(o),u=/mobile.*qq/gi.test(o);if((u||h)&&(l=!1),l){var c=window.browser||{};c.execWebFn=c.execWebFn||{},c.execWebFn.postX5GamePlayerMessage=function(e){var t=e.type;"app_enter_background"==t?i():"app_enter_foreground"==t&&n()},window.browser=c}},i}(e.HashObject);t.WebHideHandler=i,e.registerClass(i,"egret.web.WebHideHandler")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(e,t){var i="";if(null!=t)i=n(e,t);else{if(null==o){var r=document.createElement("div").style;o=n("transform",r)}i=o}return""==i?e:i+e.charAt(0).toUpperCase()+e.substring(1,e.length)}function n(e,t){if(e in t)return"";e=e.charAt(0).toUpperCase()+e.substring(1,e.length);for(var i=["webkit","ms","Moz","O"],n=0;n<i.length;n++){var r=i[n]+e;if(r in t)return i[n]}return""}var r=function(){function e(){}var t=(__define,e);t.prototype;return e.QQ_AUDIO=1,e.WEB_AUDIO=2,e.HTML5_AUDIO=3,e}();t.AudioType=r,e.registerClass(r,"egret.web.AudioType");var a=function(){function e(){}var t=(__define,e);t.prototype;return e.WPHONE=1,e.IOS=2,e.ADNROID=3,e}();t.SystemOSType=a,e.registerClass(a,"egret.web.SystemOSType");var s=function(t){function i(){t.call(this)}__extends(i,t);var n=(__define,i);n.prototype;return i._init=function(){var t=navigator.userAgent.toLowerCase();if(i.ua=t,e.Capabilities.$isMobile=-1!=t.indexOf("mobile")||-1!=t.indexOf("android"),i._canUseBlob=!1,i._audioType=r.HTML5_AUDIO,i._AudioClass=e.web.HtmlSound,i._audioMustLoad=!0,t.indexOf("windows phone")>=0)i._System_OS=a.WPHONE,i._audioMustLoad=!1,e.Capabilities.$os="Windows Phone";else if(t.indexOf("android")>=0){if(i._System_OS=a.ADNROID,t.indexOf("ucbrowser")>=0&&(i._audioMustLoad=!1),e.Capabilities.$os="Android",i._System_OS=a.ADNROID,window.hasOwnProperty("QZAppExternal")&&t.indexOf("qzone")>=0){i._audioType=r.QQ_AUDIO,i._AudioClass=e.web.QQSound;var n=document.getElementsByTagName("base");if(n&&n.length>0)i._QQRootPath=n[0].baseURI;else{var s=window.location.href.indexOf("?");-1==s&&(s=window.location.href.length);var o=window.location.href.substring(0,s);o=o.substring(0,o.lastIndexOf("/")),i._QQRootPath=o+"/"}}}else t.indexOf("iphone")>=0||t.indexOf("ipad")>=0||t.indexOf("ipod")>=0?(e.Capabilities.$os="iOS",i._System_OS=a.IOS,i.getIOSVersion()>=7&&(i._canUseBlob=!0,i._AudioClass=e.web.WebAudioSound,i._audioType=r.WEB_AUDIO)):-1!=t.indexOf("windows nt")?e.Capabilities.$os="Windows PC":-1!=t.indexOf("mac os")&&(e.Capabilities.$os="Mac OS");var h=window.URL||window.webkitURL;h||(i._canUseBlob=!1);var l=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;l||i._audioType!=r.WEB_AUDIO||(i._audioType=r.HTML5_AUDIO,i._AudioClass=e.web.HtmlSound),e.Sound=i._AudioClass},i.getIOSVersion=function(){var e=i.ua.toLowerCase().match(/cpu [^\d]*\d.*like mac os x/)[0];return parseInt(e.match(/\d(_\d)*/)[0])||0},i.checkHtml5Support=function(){var t=(navigator.language||navigator.browserLanguage).toLowerCase(),i=t.split("-");i.length>1&&(i[1]=i[1].toUpperCase()),e.Capabilities.$language=i.join("-")},i._canUseBlob=!1,i._audioType=0,i._audioMustLoad=!1,i._QQRootPath="",i._System_OS=0,i.ua="",i}(e.HashObject);t.Html5Capatibility=s,e.registerClass(s,"egret.web.Html5Capatibility"),s._init();var o=null;t.getPrefixStyleName=i,t.getPrefix=n}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(){if(o)for(var e=document.querySelectorAll(".egret-player"),t=e.length,i=0;t>i;i++){var n=e[i],r=n["egret-player"];r.updateScreenSize()}}function n(i){if(!o){o=!0,i||(i={}),r(i.renderMode);var n=e.sys.$ticker;a(n),i.screenAdapter?e.sys.screenAdapter=i.screenAdapter:e.sys.screenAdapter||(e.sys.screenAdapter=new e.sys.DefaultScreenAdapter);for(var s=document.querySelectorAll(".egret-player"),h=s.length,l=0;h>l;l++){var u=s[l],c=new t.WebPlayer(u,i);u["egret-player"]=c,"webgl"==i.renderMode&&(c.stage.dirtyRegionPolicy=e.DirtyRegionPolicy.OFF,e.sys.DisplayList.prototype.setDirtyRegionPolicy=function(){})}}}function r(i){"webgl"==i&&t.WebGLUtils.checkCanUseWebGL()?(e.sys.RenderBuffer=t.WebGLRenderBuffer,e.sys.systemRenderer=new t.WebGLRenderer,e.sys.hitTestBuffer=new t.WebGLRenderBuffer(3,3)):(e.sys.RenderBuffer=t.CanvasRenderBuffer,e.sys.systemRenderer=new e.CanvasRenderer,e.sys.hitTestBuffer=new t.CanvasRenderBuffer(3,3))}function a(e){function t(){e.update(),i.call(window,t)}var i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;i||(i=function(e){return window.setTimeout(e,1e3/60)}),i.call(window,t)}function s(){h=0/0,e.updateAllScreens()}var o=!1;window.isNaN=function(e){return e=+e,e!==e},e.runEgret=n,e.updateAllScreens=i;var h=0/0;window.addEventListener("resize",function(){isNaN(h)&&(h=window.setTimeout(s,300))})}(t=e.web||(e.web={}))}(egret||(egret={}));var language,egret;!function(e){var t;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.detect=function(){var t=e.Capabilities,i=navigator.userAgent.toLowerCase();t.$isMobile=-1!=i.indexOf("mobile")||-1!=i.indexOf("android"),t.$isMobile?i.indexOf("windows")<0&&(-1!=i.indexOf("iphone")||-1!=i.indexOf("ipad")||-1!=i.indexOf("ipod"))?t.$os="iOS":-1!=i.indexOf("android")&&-1!=i.indexOf("linux")?t.$os="Android":-1!=i.indexOf("windows")&&(t.$os="Windows Phone"):-1!=i.indexOf("windows nt")?t.$os="Windows PC":-1!=i.indexOf("mac os")&&(t.$os="Mac OS");var n=(navigator.language||navigator.browserLanguage).toLowerCase(),r=n.split("-");r.length>1&&(r[1]=r[1].toUpperCase()),t.$language=r.join("-")},t}();t.WebCapability=i,e.registerClass(i,"egret.web.WebCapability"),i.detect()}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(e){if(window.location){var t=location.search;if(""==t)return"";t=t.slice(1);for(var i=t.split("&"),n=i.length,r=0;n>r;r++){var a=i[r],s=a.split("=");if(s[0]==e)return s[1]}}return""}t.getOption=i,e.getOption=i}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(i){function n(e,t){i.call(this),this.init(e,t),this.initOrientation()}__extends(n,i);var r=(__define,n),a=r.prototype;return a.init=function(i,n){var r=this.readOption(i,n),a=new e.Stage;a.$screen=this,a.$scaleMode=r.scaleMode,a.$orientation=r.orientation,a.$maxTouches=r.maxTouches,a.frameRate=r.frameRate,a.textureScaleFactor=r.textureScaleFactor;var s=new e.sys.RenderBuffer,o=s.surface;this.attachCanvas(i,o);var h=new t.WebTouchHandler(a,o),l=new e.sys.Player(s,a,r.entryClassName),u=new e.web.WebHideHandler(a),c=new t.HTMLInput;l.showPaintRect(r.showPaintRect),(r.showFPS||r.showLog)&&l.displayFPS(r.showFPS,r.showLog,r.logFilter,r.fpsStyles),this.playerOption=r,this.container=i,this.canvas=o,this.stage=a,this.stage=a,this.player=l,this.webTouchHandler=h,this.webInput=c,this.webHide=u,e.web.$cacheTextAdapter(c,a,i,o),this.updateScreenSize(),this.updateMaxTouches(),l.start()},a.initOrientation=function(){var t=this;window.addEventListener("orientationchange",function(){window.setTimeout(function(){e.StageOrientationEvent.dispatchStageOrientationEvent(t.stage,e.StageOrientationEvent.ORIENTATION_CHANGE)},350)})},a.readOption=function(t,i){var n={};n.entryClassName=t.getAttribute("data-entry-class"),n.scaleMode=t.getAttribute("data-scale-mode")||e.StageScaleMode.NO_SCALE,n.frameRate=+t.getAttribute("data-frame-rate")||30,n.contentWidth=+t.getAttribute("data-content-width")||480,n.contentHeight=+t.getAttribute("data-content-height")||800,n.orientation=t.getAttribute("data-orientation")||e.OrientationMode.AUTO,n.maxTouches=+t.getAttribute("data-multi-fingered")||2,n.textureScaleFactor=+t.getAttribute("texture-scale-factor")||1,"webgl"==i.renderMode?n.showPaintRect=!1:n.showPaintRect="true"==t.getAttribute("data-show-paint-rect"),n.showFPS="true"==t.getAttribute("data-show-fps");for(var r=t.getAttribute("data-show-fps-style")||"",a=r.split(","),s={},o=0;o<a.length;o++){var h=a[o].split(":");s[h[0]]=h[1]}return n.fpsStyles=s,n.showLog="true"==t.getAttribute("data-show-log"),n.logFilter=t.getAttribute("data-log-filter"),n},a.attachCanvas=function(e,t){var i=t.style;i.cursor="inherit",i.position="absolute",i.top="0",i.bottom="0",i.left="0",i.right="0",e.appendChild(t),i=e.style,i.overflow="hidden",i.position="relative",i.webkitTransform="translateZ(0)"},a.updateScreenSize=function(){var t=this.canvas;if(!t.userTyping){var i=this.playerOption,n=this.container.getBoundingClientRect(),r=!1,a=this.stage.$orientation;a!=e.OrientationMode.AUTO&&(r=a!=e.OrientationMode.PORTRAIT&&n.height>n.width||a==e.OrientationMode.PORTRAIT&&n.width>n.height);var s=r?n.height:n.width,o=r?n.width:n.height,h=e.sys.screenAdapter.calculateStageSize(this.stage.$scaleMode,s,o,i.contentWidth,i.contentHeight),l=h.stageWidth,u=h.stageHeight,c=h.displayWidth,d=h.displayHeight;t.width!==l&&(t.width=l),t.height!==u&&(t.height=u),t.style[e.web.getPrefixStyleName("transformOrigin")]="0% 0% 0px",t.style.width=c+"px",t.style.height=d+"px";var f=0;r?a==e.OrientationMode.LANDSCAPE?(f=90,t.style.top=(n.height-c)/2+"px",t.style.left=(n.width+d)/2+"px"):(f=-90,t.style.top=(n.height+c)/2+"px",t.style.left=(n.width-d)/2+"px"):(t.style.top=(n.height-d)/2+"px",t.style.left=(n.width-c)/2+"px");var g="rotate("+f+"deg)";t.style[e.web.getPrefixStyleName("transform")]=g;var p=c/l,v=d/u;this.webTouchHandler.updateScaleMode(p,v,f),this.webInput.$updateSize(),this.player.updateStageSize(l,u)}},a.setContentSize=function(e,t){var i=this.playerOption;i.contentWidth=e,i.contentHeight=t,this.updateScreenSize()},a.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},n}(e.HashObject);t.WebPlayer=i,e.registerClass(i,"egret.web.WebPlayer",["egret.sys.Screen"])}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(t,i){var n=e.sys.hitTestBuffer,r=t.$getTextureWidth(),a=t.$getTextureHeight();null==i&&(i=e.$TempRectangle,i.x=0,i.y=0,i.width=r,i.height=a),i.x=Math.min(i.x,r-1),i.y=Math.min(i.y,a-1),i.width=Math.min(i.width,r-i.x),i.height=Math.min(i.height,a-i.y);var s=i.width,o=i.height,h=n.surface;h.style.width=s+"px",h.style.height=o+"px",n.resize(s,o);var l=t,u=Math.round(l._offsetX),c=Math.round(l._offsetY),d=l._bitmapWidth,f=l._bitmapHeight;return n.context.drawImage(l._bitmapData,l._bitmapX+i.x/e.$TextureScaleFactor,l._bitmapY+i.y/e.$TextureScaleFactor,d*i.width/r,f*i.height/a,u,c,i.width,i.height),h}function n(t,n){try{var r=i(this,n),a=r.toDataURL(t);return a}catch(s){e.$error(1033)}return null}function r(e,t,i){var r=n.call(this,e,i);if(null!=r){var a=r.replace(/^data:image[^;]*/,"data:image/octet-stream"),s=document.createElement("a");s.download=t,s.href=a;var o=document.createEvent("HTMLEvents");o.initEvent("click",!1,!1),s.dispatchEvent(o)}}function a(t,i){var n=e.sys.hitTestBuffer;n.resize(3,3);var r=n.context;r.translate(1-t,1-i);var a=this._bitmapWidth,s=this._bitmapHeight,o=e.$TextureScaleFactor;r.drawImage(this._bitmapData,this._bitmapX,this._bitmapY,a,this._bitmapHeight,this._offsetX,this._offsetY,a*o,s*o);try{var h=r.getImageData(1,1,1,1).data}catch(l){throw console.log(this),new Error(e.sys.tr(1039))}return h}e.Texture.prototype.toDataURL=n,e.Texture.prototype.saveToFile=r,e.Texture.prototype.getPixel32=a}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(e){for(var t=o.parseFromString(e,"text/xml"),i=t.childNodes.length,r=0;i>r;r++){var a=t.childNodes[r];if(1==a.nodeType)return n(a,null)}return null}function n(e,t){if("parsererror"==e.localName)throw new Error(e.textContent);for(var i=new a(e.localName,t,e.prefix,e.namespaceURI,e.nodeName),r=e.attributes,o=i.attributes,h=r.length,l=0;h>l;l++){var u=r[l],c=u.name;0!=c.indexOf("xmlns:")&&(o[c]=u.value,i["$"+c]=u.value)}var d=e.childNodes;h=d.length;var f=i.children;for(l=0;h>l;l++){var g=d[l],p=g.nodeType,v=null;if(1==p)v=n(g,i);else if(3==p){var m=g.textContent.trim();m&&(v=new s(m,i))}v&&f.push(v)}return i}var r=function(){function e(e,t){this.nodeType=e,this.parent=t}var t=(__define,e);t.prototype;return e}();t.XMLNode=r,e.registerClass(r,"egret.web.XMLNode");var a=function(e){function t(t,i,n,r,a){e.call(this,1,i),this.attributes={},this.children=[],this.localName=t,this.prefix=n,this.namespace=r,this.name=a}__extends(t,e);var i=(__define,t);i.prototype;return t}(r);t.XML=a,e.registerClass(a,"egret.web.XML");var s=function(e){function t(t,i){e.call(this,3,i),this.text=t}__extends(t,e);var i=(__define,t);i.prototype;return t}(r);t.XMLText=s,e.registerClass(s,"egret.web.XMLText");var o=new DOMParser;e.XML={parse:i}}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(){var i=this;t.apply(this,arguments),this.onChange=function(t){var n=new e.OrientationEvent(e.Event.CHANGE);n.beta=t.beta,n.gamma=t.gamma,n.alpha=t.alpha,i.dispatchEvent(n)}}__extends(i,t);var n=(__define,i),r=n.prototype;return r.start=function(){window.addEventListener("deviceorientation",this.onChange)},r.stop=function(){window.removeEventListener("deviceorientation",this.onChange)},i}(e.EventDispatcher);t.WebDeviceOrientation=i,e.registerClass(i,"egret.web.WebDeviceOrientation",["egret.DeviceOrientation"])}(t=e.web||(e.web={}))}(egret||(egret={})),egret.DeviceOrientation=egret.web.WebDeviceOrientation;var egret;!function(e){var t;!function(t){var i=function(t){function i(i){var n=this;t.call(this),this.onUpdate=function(t){var i=new e.GeolocationEvent(e.Event.CHANGE),r=t.coords;i.altitude=r.altitude,i.heading=r.heading,i.accuracy=r.accuracy,i.latitude=r.latitude,i.longitude=r.longitude,i.speed=r.speed,i.altitudeAccuracy=r.altitudeAccuracy,n.dispatchEvent(i)},this.onError=function(t){var i=e.GeolocationEvent.UNAVAILABLE;t.code==t.PERMISSION_DENIED&&(i=e.GeolocationEvent.PERMISSION_DENIED);var r=new e.GeolocationEvent(e.IOErrorEvent.IO_ERROR);r.errorType=i,r.errorMessage=t.message,n.dispatchEvent(r)},this.geolocation=navigator.geolocation}__extends(i,t);var n=(__define,i),r=n.prototype;return r.start=function(){var t=this.geolocation;t?this.watchId=t.watchPosition(this.onUpdate,this.onError):this.onError({code:2,message:e.sys.tr(3004),PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2})},r.stop=function(){var e=this.geolocation;e.clearWatch(this.watchId)},i}(e.EventDispatcher);t.WebGeolocation=i,e.registerClass(i,"egret.web.WebGeolocation",["egret.Geolocation"]),e.Geolocation=e.web.WebGeolocation}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(t){function i(){var i=this;t.apply(this,arguments),this.onChange=function(t){var n=new e.MotionEvent(e.Event.CHANGE),r={x:t.acceleration.x,y:t.acceleration.y,z:t.acceleration.z},a={x:t.accelerationIncludingGravity.x,y:t.accelerationIncludingGravity.y,z:t.accelerationIncludingGravity.z},s={alpha:t.rotationRate.alpha,beta:t.rotationRate.beta,gamma:t.rotationRate.gamma};n.acceleration=r,n.accelerationIncludingGravity=a,n.rotationRate=s,i.dispatchEvent(n)}}__extends(i,t);var n=(__define,i),r=n.prototype;return r.start=function(){window.addEventListener("devicemotion",this.onChange)},r.stop=function(){window.removeEventListener("devicemotion",this.onChange)},i}(e.EventDispatcher);t.WebMotion=i,e.registerClass(i,"egret.web.WebMotion",["egret.Motion"]),e.Motion=e.web.WebMotion}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(e){}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function t(){}var i=(__define,t);i.prototype;return t.compileProgram=function(i,n,r){var a=t.compileFragmentShader(i,r),s=t.compileVertexShader(i,n),o=i.createProgram();return i.attachShader(o,s),i.attachShader(o,a),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)||e.$warn(1020),o},t.compileFragmentShader=function(e,i){return t._compileShader(e,i,e.FRAGMENT_SHADER)},t.compileVertexShader=function(e,i){return t._compileShader(e,i,e.VERTEX_SHADER)},t._compileShader=function(e,t,i){var n=e.createShader(i);return e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:null},t.checkCanUseWebGL=function(){if(void 0==t.canUseWebGL)try{var e=document.createElement("canvas");t.canUseWebGL=!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(i){t.canUseWebGL=!1}return t.canUseWebGL},t.deleteWebGLTexture=function(e){if(e){var t=e.webGLTexture;if(t)for(var i in t){var n=t[i],r=n.glContext;r.deleteTexture(n)}e.webGLTexture=null}},t}();t.WebGLUtils=i,e.registerClass(i,"egret.web.WebGLUtils")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function e(e){this.defaultVertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nuniform vec2 offsetVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",this.gl=null,this.program=null,this.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\ngl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;\n}",this.uniforms=null,this.gl=e,this.init()}var i=(__define,e),n=i.prototype;return n.init=function(){var e=this.gl,i=t.WebGLUtils.compileProgram(e,this.defaultVertexSrc,this.fragmentSrc);e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.dimensions=e.getUniformLocation(i,"dimensions"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var n in this.uniforms)this.uniforms[n].uniformLocation=e.getUniformLocation(i,n);this.initUniforms(),this.program=i},n.initUniforms=function(){if(this.uniforms){var e,t=this.gl;for(var i in this.uniforms){e=this.uniforms[i];var n=e.type;"mat2"===n||"mat3"===n||"mat4"===n?(e.glMatrix=!0,e.glValueLength=1,"mat2"===n?e.glFunc=t.uniformMatrix2fv:"mat3"===n?e.glFunc=t.uniformMatrix3fv:"mat4"===n&&(e.glFunc=t.uniformMatrix4fv)):(e.glFunc=t["uniform"+n],"2f"===n||"2i"===n?e.glValueLength=2:"3f"===n||"3i"===n?e.glValueLength=3:"4f"===n||"4i"===n?e.glValueLength=4:e.glValueLength=1)}}},n.syncUniforms=function(){if(this.uniforms){var e,t=this.gl;for(var i in this.uniforms)e=this.uniforms[i],1===e.glValueLength?e.glMatrix===!0?e.glFunc.call(t,e.uniformLocation,e.transpose,e.value):e.glFunc.call(t,e.uniformLocation,e.value):2===e.glValueLength?e.glFunc.call(t,e.uniformLocation,e.value.x,e.value.y):3===e.glValueLength?e.glFunc.call(t,e.uniformLocation,e.value.x,e.value.y,e.value.z):4===e.glValueLength&&e.glFunc.call(t,e.uniformLocation,e.value.x,e.value.y,e.value.z,e.value.w)}},e}();t.EgretShader=i,e.registerClass(i,"egret.web.EgretShader")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function e(e){this.gl=null,this.program=null,this.projectionVector=null,this.offsetVector=null,this.tintColor=null,this.aVertexPosition=null,this.colorAttribute=null,this.attributes=null,this.translationMatrix=null,this.alpha=null,this.fragmentSrc="precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n   gl_FragColor = vColor;\n}",this.vertexSrc="attribute vec2 aVertexPosition;\nattribute vec4 aColor;\nuniform mat3 translationMatrix;\nuniform vec2 projectionVector;\nuniform vec2 offsetVector;\nuniform float alpha;\nuniform vec3 tint;\nvarying vec4 vColor;\nvoid main(void) {\n   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);\n   v -= offsetVector.xyx;\n   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);\n   vColor = aColor * vec4(tint * alpha, alpha);\n}",this.gl=e,this.init()}var i=(__define,e),n=i.prototype;return n.init=function(){var e=this.gl,i=t.WebGLUtils.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.tintColor=e.getUniformLocation(i,"tint"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=e.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=e.getUniformLocation(i,"translationMatrix"),this.alpha=e.getUniformLocation(i,"alpha"),this.program=i},e}();t.PrimitiveShader=i,e.registerClass(i,"egret.web.PrimitiveShader")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(e){function t(t){e.call(this,t),this.fragmentSrc="precision mediump float;uniform vec2 blur;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){gl_FragColor = vec4(0.0);gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.028 * blur.x, -0.028 * blur.y))) * 0.0044299121055113265;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.024 * blur.x, -0.024 * blur.y))) * 0.00895781211794;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.020 * blur.x, -0.020 * blur.y))) * 0.0215963866053;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.016 * blur.x, -0.016 * blur.y))) * 0.0443683338718;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.012 * blur.x, -0.012 * blur.y))) * 0.0776744219933;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.008 * blur.x, -0.008 * blur.y))) * 0.115876621105;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2(-0.004 * blur.x, -0.004 * blur.y))) * 0.147308056121;gl_FragColor += texture2D(uSampler, vTextureCoord) * 0.159576912161;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.004 * blur.x,  0.004 * blur.y))) * 0.147308056121;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.008 * blur.x,  0.008 * blur.y))) * 0.115876621105;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.012 * blur.x,  0.012 * blur.y))) * 0.0776744219933;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.016 * blur.x,  0.016 * blur.y))) * 0.0443683338718;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.020 * blur.x,  0.020 * blur.y))) * 0.0215963866053;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.024 * blur.x,  0.024 * blur.y))) * 0.00895781211794;gl_FragColor += texture2D(uSampler, (vTextureCoord + vec2( 0.028 * blur.x,  0.028 * blur.y))) * 0.0044299121055113265;}",this.uniforms={blur:{type:"2f",value:{x:2,y:2}}},this.init()}__extends(t,e);var i=(__define,t);i.prototype;return t}(t.EgretShader);t.BlurShader=i,e.registerClass(i,"egret.web.BlurShader")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(e){function t(t){e.call(this,t),this.fragmentSrc="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform float invert;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\nvec4 texColor = texture2D(uSampler, vTextureCoord);\nvec4 locColor = texColor * matrix;\nif(texColor.a != 0.0){\nlocColor += colorAdd;\n}\ngl_FragColor = vColor*vec4(locColor.rgb*locColor.a,locColor.a);\n}",this.uniforms={matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},colorAdd:{type:"4f",value:{x:0,y:0,z:0,w:0}}},this.init()}__extends(t,e);var i=(__define,t);i.prototype;return t}(t.EgretShader);t.ColorTransformShader=i,e.registerClass(i,"egret.web.ColorTransformShader")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=function(){function e(e){this.gl=null,this.maxAttibs=10,this.attribState=[],this.tempAttribState=[],this.currentShader=null,this.defaultShader=null,this.primitiveShader=null,this.colorTransformShader=null,this.blurShader=null;for(var t=0;t<this.maxAttibs;t++)this.attribState[t]=!1;this.setContext(e)}var i=(__define,e),n=i.prototype;return n.setContext=function(e){this.gl=e,this.primitiveShader=new t.PrimitiveShader(e),this.defaultShader=new t.EgretShader(e),this.colorTransformShader=new t.ColorTransformShader(e),this.blurShader=new t.BlurShader(e),this.activateShader(this.defaultShader)},n.activateShader=function(e){this.currentShader!=e&&(this.gl.useProgram(e.program),this.setAttribs(e.attributes),this.currentShader=e)},n.setAttribs=function(e){var t,i;for(i=this.tempAttribState.length,t=0;i>t;t++)this.tempAttribState[t]=!1;for(i=e.length,t=0;i>t;t++){var n=e[t];this.tempAttribState[n]=!0}var r=this.gl;for(i=this.attribState.length,t=0;i>t;t++)this.attribState[t]!==this.tempAttribState[t]&&(this.attribState[t]=this.tempAttribState[t],this.tempAttribState[t]?r.enableVertexAttribArray(t):r.disableVertexAttribArray(t))},e}();t.WebGLShaderManager=i,e.registerClass(i,"egret.web.WebGLShaderManager")}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){function i(t,i){var n=document.createElement("canvas");return isNaN(t)||isNaN(i)||(n.width=t,n.height=i),e.$toBitmapData(n),n}var n=i(),r=function(){function r(t,n){this.glID=null,this.size=2e3,this.vertices=null,this.vertSize=5,this.indices=null,this.projectionX=0/0,this.projectionY=0/0,this.shaderManager=null,this.contextLost=!1,this.currentBaseTexture=null,this.currentBatchSize=0,this.drawData=[],this.$drawCalls=0,this.$computeDrawCall=!1,this.globalMatrix=new e.Matrix,this.savedGlobalMatrix=new e.Matrix,this._globalAlpha=1,this.$stencilList=[],this.graphicsPoints=null,this.graphicsIndices=null,this.graphicsBuffer=null,this.graphicsIndexBuffer=null,this.graphicsStyle={a:1,r:255,g:0,b:0},this.surface=i(t,n),this.initWebGL()}var s=__define,o=r,h=o.prototype;return s(h,"width",function(){return this.surface.width}),s(h,"height",function(){return this.surface.height}),h.resize=function(e,t,i){var n=this.surface;i?(n.width<e&&(n.width=e),n.height<t&&(n.height=t)):(n.width!=e&&(n.width=e),n.height!=t&&(n.height=t)),this.onResize(),this.clear()},h.resizeTo=function(e,t,i,n){var r=a,s=this.surface,o=this.context;this.context=r.context,this.surface=r.surface,this.resize(Math.max(e,257),Math.max(t,257)),this.setTransform(1,0,0,1,0,0),this.setGlobalCompositeOperation("source-over"),this.drawImage(s,0,0,s.width,s.height,i,n,s.width,s.height),a.context=o,a.surface=s,a.resize(1,1)},h.beginClip=function(e,t,i){this.clear()},h.endClip=function(){},h.getPixel=function(e,t){var i=n,r=i.getContext("2d");return i.width=this.surface.width,i.height=this.surface.height,r.drawImage(this.surface,0,0),r.getImageData(e,t,1,1).data},h.toDataURL=function(e,t){return this.surface.toDataURL(e,t)},h.clear=function(){this.clearRect(0,0,this.surface.width,this.surface.height)},h.clearRect=function(e,t,i,n){var r=this.context;r.colorMask(!0,!0,!0,!0),r.viewport(e,t,i,n),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT)},h.destroy=function(){this.surface.width=this.surface.height=0},h.onResize=function(){this.projectionX=this.surface.width/2,this.projectionY=-this.surface.height/2,this.context&&this.context.viewport(0,0,this.surface.width,this.surface.height)},h.initWebGL=function(){this.onResize(),this.surface.addEventListener("webglcontextlost",this.handleContextLost.bind(this),!1),this.surface.addEventListener("webglcontextrestored",this.handleContextRestored.bind(this),!1);var e=4*this.size*this.vertSize,i=6*this.size;this.vertices=new Float32Array(e),this.indices=new Uint16Array(i);for(var n=0,r=0;i>n;n+=6,r+=4)this.indices[n+0]=r+0,this.indices[n+1]=r+1,this.indices[n+2]=r+2,this.indices[n+3]=r+0,this.indices[n+4]=r+2,this.indices[n+5]=r+3;this.getWebGLContext(),this.shaderManager=new t.WebGLShaderManager(this.context)
},h.handleContextLost=function(){this.contextLost=!0},h.handleContextRestored=function(){this.initWebGL(),this.shaderManager.setContext(this.context),this.contextLost=!1},h.getWebGLContext=function(){for(var t,i={stencil:!0},n=["webgl","experimental-webgl"],r=0;r<n.length;r++){try{t=this.surface.getContext(n[r],i)}catch(a){}if(t)break}t||e.$error(1021),this.setContext(t),this.setGlobalCompositeOperation("source-over")},h.setContext=function(e){this.context=e,e.id=r.glContextId++,this.glID=e.id,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.colorMask(!0,!0,!0,!0)},h.drawImage=function(e,t,i,n,r,a,s,o,h){this.contextLost||e&&this._drawImage(e,t,i,n,r,a,s,o,h)},h._drawImage=function(e,t,i,n,r,a,s,o,h){var l=e.width,u=e.height;this.createWebGLTexture(e);var c=e.webGLTexture[this.glID];if(c){this.currentBatchSize>=this.size-1?(this.$drawWebGL(),this.drawData.push({texture:this.currentBaseTexture,count:0})):c!==this.currentBaseTexture&&(this.currentBaseTexture=c,this.drawData.push({texture:this.currentBaseTexture,count:0}));var d=this.globalMatrix,f=d.a,g=d.b,p=d.c,v=d.d,m=d.tx,x=d.ty;(0!=a||0!=s)&&d.append(1,0,0,1,a,s),(n/o!=1||r/h!=1)&&d.append(o/n,0,0,h/r,0,0);var b=d.a,w=d.b,y=d.c,E=d.d,_=d.tx,S=d.ty;d.a=f,d.b=g,d.c=p,d.d=v,d.tx=m,d.ty=x;var T=l,C=u,L=n,A=r;t/=T,i/=C,n/=T,r/=C;var R=this.vertices,$=4*this.currentBatchSize*this.vertSize,D=this._globalAlpha;R[$++]=_,R[$++]=S,R[$++]=t,R[$++]=i,R[$++]=D,R[$++]=b*L+_,R[$++]=w*L+S,R[$++]=n+t,R[$++]=i,R[$++]=D,R[$++]=b*L+y*A+_,R[$++]=E*A+w*L+S,R[$++]=n+t,R[$++]=r+i,R[$++]=D,R[$++]=y*A+_,R[$++]=E*A+S,R[$++]=t,R[$++]=r+i,R[$++]=D,this.currentBatchSize++,this.drawData[this.drawData.length-1].count++}},h.$drawWebGL=function(){if(0!=this.currentBatchSize&&!this.contextLost){this.start();var e=this.context,t=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,t);for(var i=this.drawData.length,n=0,a=0;i>a;a++){var s=this.drawData[a];if(s.texture){e.bindTexture(e.TEXTURE_2D,s.texture);var o=6*s.count;e.drawElements(e.TRIANGLES,o,e.UNSIGNED_SHORT,2*n),n+=o,this.$computeDrawCall&&this.$drawCalls++}else{var h=r.blendModesForGL[s];h&&this.context.blendFunc(h[0],h[1])}}this.drawData.length=0,this.currentBatchSize=0,this.currentBaseTexture=null}},h.start=function(){if(!this.contextLost){var e=this.context;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var t;t="colorTransform"==this.filterType?this.shaderManager.colorTransformShader:"blur"==this.filterType?this.shaderManager.blurShader:this.shaderManager.defaultShader,this.shaderManager.activateShader(t),t.syncUniforms(),e.uniform2f(t.projectionVector,this.projectionX,this.projectionY);var i=4*this.vertSize;e.vertexAttribPointer(t.aVertexPosition,2,e.FLOAT,!1,i,0),e.vertexAttribPointer(t.aTextureCoord,2,e.FLOAT,!1,i,8),e.vertexAttribPointer(t.colorAttribute,2,e.FLOAT,!1,i,16)}},h.createWebGLTexture=function(e){var t=e;if(t.webGLTexture||(t.webGLTexture={}),!t.webGLTexture[this.glID]){var i=this.context,n=i.createTexture();if(t.webGLTexture[this.glID]=n,!n)return void(this.contextLost=!0);n.glContext=i,i.bindTexture(i.TEXTURE_2D,n),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null)}},h.onRenderFinish=function(){this.$drawCalls=0},h.setTransform=function(e,t,i,n,r,a){this.globalMatrix.setTo(e,t,i,n,r,a)},h.transform=function(e,t,i,n,r,a){this.globalMatrix.append(e,t,i,n,r,a)},h.saveTransform=function(){this.savedGlobalMatrix.copyFrom(this.globalMatrix)},h.restoreTransform=function(){this.globalMatrix.copyFrom(this.savedGlobalMatrix)},h.setGlobalAlpha=function(e){this._globalAlpha=e},h.setGlobalCompositeOperation=function(e){this.currentBlendMode!=e&&(this.drawData.push(e),this.currentBlendMode=e,this.currentBaseTexture=null)},h.pushMask=function(e){this.$drawWebGL();var t=this.context;0===this.$stencilList.length&&(t.enable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT));var i=this.$stencilList.length;this.$stencilList.push(e),t.colorMask(!1,!1,!1,!1),t.stencilFunc(t.EQUAL,i,255),t.stencilOp(t.KEEP,t.KEEP,t.INCR);var n=e.length;if(n)for(var r=0;n>r;r++){var a=e[r];this.renderGraphics({x:a.minX,y:a.minY,width:a.width,height:a.height})}else this.renderGraphics(e);t.stencilFunc(t.EQUAL,i+1,255),t.colorMask(!0,!0,!0,!0),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},h.popMask=function(){this.$drawWebGL();var e=this.context,t=this.$stencilList.pop();if(0===this.$stencilList.length)e.disable(e.STENCIL_TEST);else{var i=this.$stencilList.length;e.colorMask(!1,!1,!1,!1),e.stencilFunc(e.EQUAL,i+1,255),e.stencilOp(e.KEEP,e.KEEP,e.DECR);var n=t.length;if(n)for(var r=0;n>r;r++){var a=t[r];this.renderGraphics({x:a.minX,y:a.minY,width:a.width,height:a.height})}else this.renderGraphics(t);e.stencilFunc(e.EQUAL,i,255),e.colorMask(!0,!0,!0,!0),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}},h.renderGraphics=function(e){this.$drawWebGL();var t=this.context,i=this.shaderManager.primitiveShader;this.graphicsPoints?(this.graphicsPoints.length=0,this.graphicsIndices.length=0):(this.graphicsPoints=[],this.graphicsIndices=[],this.graphicsBuffer=t.createBuffer(),this.graphicsIndexBuffer=t.createBuffer()),this.updateGraphics(e),this.shaderManager.activateShader(i),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.uniformMatrix3fv(i.translationMatrix,!1,this.matrixToArray(this.globalMatrix)),t.uniform2f(i.projectionVector,this.projectionX,-this.projectionY),t.uniform2f(i.offsetVector,0,0),t.uniform3fv(i.tintColor,[1,1,1]),t.uniform1f(i.alpha,this._globalAlpha),t.bindBuffer(t.ARRAY_BUFFER,this.graphicsBuffer),t.vertexAttribPointer(i.aVertexPosition,2,t.FLOAT,!1,24,0),t.vertexAttribPointer(i.colorAttribute,4,t.FLOAT,!1,24,8),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.graphicsIndexBuffer),t.drawElements(t.TRIANGLE_STRIP,this.graphicsIndices.length,t.UNSIGNED_SHORT,0),this.shaderManager.activateShader(this.shaderManager.defaultShader),this.currentBlendMode=null,this.setGlobalCompositeOperation("source-over")},h.matrixToArray=function(e){return this.matrixArray||(this.matrixArray=new Float32Array(9)),this.matrixArray[0]=e.a,this.matrixArray[1]=e.b,this.matrixArray[2]=0,this.matrixArray[3]=e.c,this.matrixArray[4]=e.d,this.matrixArray[5]=0,this.matrixArray[6]=e.tx,this.matrixArray[7]=e.ty,this.matrixArray[8]=1,this.matrixArray},h.updateGraphics=function(e){var t=this.context;this.buildRectangle(e),t.bindBuffer(t.ARRAY_BUFFER,this.graphicsBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.graphicsPoints),t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.graphicsIndexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.graphicsIndices),t.STATIC_DRAW)},h.buildRectangle=function(e){var t=e.x,i=e.y,n=e.width,r=e.height,a=this.graphicsStyle.a,s=this.graphicsStyle.r*a,o=this.graphicsStyle.g*a,h=this.graphicsStyle.b*a,l=this.graphicsPoints,u=this.graphicsIndices,c=l.length/6;l.push(t,i),l.push(s,o,h,a),l.push(t+n,i),l.push(s,o,h,a),l.push(t,i+r),l.push(s,o,h,a),l.push(t+n,i+r),l.push(s,o,h,a),u.push(c,c,c+1,c+2,c+3,c+3)},r.initBlendMode=function(){r.blendModesForGL={},r.blendModesForGL["source-over"]=[1,771],r.blendModesForGL.lighter=[770,1],r.blendModesForGL["destination-out"]=[0,771],r.blendModesForGL["destination-in"]=[0,770]},r.glContextId=0,r.blendModesForGL=null,r}();t.WebGLRenderBuffer=r,e.registerClass(r,"egret.web.WebGLRenderBuffer",["egret.sys.RenderBuffer"]),r.initBlendMode();var a=new r}(t=e.web||(e.web={}))}(egret||(egret={}));var egret;!function(e){var t;!function(t){var i=["source-over","lighter","destination-out"],n="source-over",r=[],a=function(){function a(){this.nestLevel=0}var s=(__define,a),o=s.prototype;return o.render=function(e,t,i,n,a){this.nestLevel++;var s=t,o=a?e:null;this.drawDisplayObject(e,s,n,i,null,null,o),s.$drawWebGL();var h=s.$drawCalls;if(s.onRenderFinish(),this.nestLevel--,0===this.nestLevel){r.length>6&&(r.length=6);for(var l=r.length,u=0;l>u;u++)r[u].resize(0,0)}return h},o.drawDisplayObject=function(t,i,n,r,a,s,o){var h,l=0;if(a&&!o?(a.isDirty&&(l+=a.drawToSurface()),h=a.$renderNode):h=t.$getRenderNode(),h){if(n){var u=h.renderRegion;if(s&&!s.intersects(u))h.needRedraw=!1;else if(!h.needRedraw)for(var c=n.length,d=0;c>d;d++)if(u.intersects(n[d])){h.needRedraw=!0;break}}else h.needRedraw=!0;if(h.needRedraw){l++;var f,g;o?(f=t.$getConcatenatedAlphaAt(o,t.$getConcatenatedAlpha()),g=e.Matrix.create().copyFrom(t.$getConcatenatedMatrix()),t.$getConcatenatedMatrixAt(o,g),r.$preMultiplyInto(g,g),i.setTransform(g.a,g.b,g.c,g.d,g.tx,g.ty),e.Matrix.release(g)):(f=h.renderAlpha,g=h.renderMatrix,i.setTransform(g.a,g.b,g.c,g.d,g.tx+r.tx,g.ty+r.ty)),i.setGlobalAlpha(f),this.renderNode(h,i),h.needRedraw=!1}}if(a&&!o)return l;var p=t.$children;if(p)for(var v=p.length,m=0;v>m;m++){var x=p[m];!x.$visible||x.$alpha<=0||x.$maskedObject||(0!==x.$blendMode||x.$mask&&(x.$mask.$parentDisplayList||o)?l+=this.drawWithClip(x,i,n,r,s,o):x.$scrollRect||x.$maskRect?l+=this.drawWithScrollRect(x,i,n,r,s,o):x.isFPS?(i.$drawWebGL(),i.$computeDrawCall=!1,this.drawDisplayObject(x,i,n,r,x.$displayList,s,o),i.$drawWebGL(),i.$computeDrawCall=!0):l+=this.drawDisplayObject(x,i,n,r,x.$displayList,s,o))}return l},o.drawWithClip=function(a,s,o,h,l,u){var c=0,d=0!==a.$blendMode;if(d){var f=i[a.$blendMode];f||(f=n)}var g,p=a.$scrollRect?a.$scrollRect:a.$maskRect,v=a.$mask,m=e.Matrix.create();if(m.copyFrom(a.$getConcatenatedMatrix()),a.$parentDisplayList){var x,b=a.$parentDisplayList.root;b!==a.$stage&&a.$getConcatenatedMatrixAt(b,m)}if(v){var w=v.$getOriginalBounds();g=e.sys.Region.create();var y=e.Matrix.create();y.copyFrom(v.$getConcatenatedMatrix()),x&&x.$preMultiplyInto(y,y),g.updateRegion(w,y),e.Matrix.release(y)}var E;if(p&&(E=e.sys.Region.create(),E.updateRegion(p,m)),E&&g?(E.intersect(g),e.sys.Region.release(g)):!E&&g&&(E=g),E){if(E.isEmpty()||l&&!l.intersects(E))return e.sys.Region.release(E),e.Matrix.release(m),c}else E=e.sys.Region.create(),w=a.$getOriginalBounds(),E.updateRegion(w,m);var _=!1;if(o){for(var S=o.length,T=0;S>T;T++)if(E.intersects(o[T])){_=!0;break}}else _=!0;if(!_)return e.sys.Region.release(E),e.Matrix.release(m),c;if(v||a.$children&&0!=a.$children.length){var C=this.createRenderBuffer(E.width,E.height),L=C.context;if(!L)return c+=this.drawDisplayObject(a,s,o,h,a.$displayList,l,u),e.sys.Region.release(E),e.Matrix.release(m),c;if(p){var y=m;C.setTransform(y.a,y.b,y.c,y.d,y.tx-E.minX,y.ty-E.minY),C.pushMask(p)}C.setTransform(1,0,0,1,-E.minX,-E.minY);var A=e.Matrix.create().setTo(1,0,0,1,-E.minX,-E.minY);if(c+=this.drawDisplayObject(a,C,o,A,a.$displayList,E,u?a:null),e.Matrix.release(A),v){var R=this.createRenderBuffer(E.width,E.height),$=R.context;if(!$)return c+=this.drawDisplayObject(a,s,o,h,a.$displayList,l,u),C.popMask(),r.push(C),e.sys.Region.release(E),e.Matrix.release(m),c;R.setTransform(1,0,0,1,-E.minX,-E.minY),A=e.Matrix.create().setTo(1,0,0,1,-E.minX,-E.minY);var D=this.drawDisplayObject(v,R,o,A,v.$displayList,E,u?v:null);e.Matrix.release(A),D>0&&(c+=D,C.setGlobalCompositeOperation("destination-in"),C.setTransform(1,0,0,1,0,0),C.setGlobalAlpha(1),R.$drawWebGL(),t.WebGLUtils.deleteWebGLTexture(R.surface),C.drawImage(R.surface,0,0,R.surface.width,R.surface.height,0,0,R.surface.width,R.surface.height)),r.push(R)}return c>0&&(c++,d&&s.setGlobalCompositeOperation(f),s.setGlobalAlpha(1),s.setTransform(1,0,0,1,E.minX+h.tx,E.minY+h.ty),C.$drawWebGL(),t.WebGLUtils.deleteWebGLTexture(C.surface),s.drawImage(C.surface,0,0,C.surface.width,C.surface.height,0,0,C.surface.width,C.surface.height),d&&s.setGlobalCompositeOperation(n)),C.setGlobalCompositeOperation(n),r.push(C),e.sys.Region.release(E),e.Matrix.release(m),c}p&&s.pushMask(p);var A=e.Matrix.create().setTo(1,0,0,1,0,0);return d&&s.setGlobalCompositeOperation(f),c+=this.drawDisplayObject(a,s,o,A,a.$displayList,E,null),e.Matrix.release(A),d&&s.setGlobalCompositeOperation(n),e.sys.Region.release(E),e.Matrix.release(m),c},o.drawWithScrollRect=function(t,i,n,r,a,s){var o=0,h=t.$scrollRect?t.$scrollRect:t.$maskRect;if(0==h.width||0==h.height)return o;var l=e.Matrix.create();if(l.copyFrom(t.$getConcatenatedMatrix()),t.$parentDisplayList){var u=t.$parentDisplayList.root;u!==t.$stage&&t.$getConcatenatedMatrixAt(u,l)}var c=e.sys.Region.create();if(h.isEmpty()||c.updateRegion(h,l),c.isEmpty()||a&&!a.intersects(c))return e.sys.Region.release(c),e.Matrix.release(l),o;var d=!1;if(n){for(var f=n.length,g=0;f>g;g++)if(c.intersects(n[g])){d=!0;break}}else d=!0;return d?(i.setTransform(l.a,l.b,l.c,l.d,l.tx+r.tx,l.ty+r.ty),i.pushMask(h),o+=this.drawDisplayObject(t,i,n,r,t.$displayList,c,s),i.popMask(),e.sys.Region.release(c),e.Matrix.release(l),o):(e.sys.Region.release(c),e.Matrix.release(l),o)},o.drawNodeToBuffer=function(e,t,i,n){var r=t;r.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),this.renderNode(e,t,n),t.$drawWebGL()},o.renderNode=function(e,t,i){switch(e.type){case 1:this.renderBitmap(e,t);break;case 2:this.renderText(e,t);break;case 3:this.renderGraphics(e,t,i);break;case 4:this.renderGroup(e,t);break;case 5:t.setTransform(e.drawData[0],e.drawData[1],e.drawData[2],e.drawData[3],e.drawData[4],e.drawData[5]);break;case 6:t.setGlobalAlpha(e.drawData[0])}},o.renderBitmap=function(e,t){var i=e.image,n=e.drawData,r=n.length,a=0,s=e.matrix;for(s&&(t.saveTransform(),t.transform(s.a,s.b,s.c,s.d,s.tx,s.ty));r>a;)t.drawImage(i,n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++],n[a++]);s&&t.restoreTransform()},o.renderText=function(i,n){var r=i.width-i.x,a=i.height-i.y;0!=i.drawData.length&&(i.$canvasRenderBuffer&&i.$canvasRenderBuffer.context?i.$canvasRenderBuffer.resize(r,a,!0):(i.$canvasRenderer=new e.CanvasRenderer,i.$canvasRenderBuffer=new t.CanvasRenderBuffer(r,a)),i.$canvasRenderBuffer.context&&((i.x||i.y)&&(i.dirtyRender&&i.$canvasRenderBuffer.context.translate(-i.x,-i.y),n.transform(1,0,0,1,i.x,i.y)),i.dirtyRender&&(t.WebGLUtils.deleteWebGLTexture(i.$canvasRenderBuffer.surface),i.$canvasRenderer.renderText(i,i.$canvasRenderBuffer.context)),n.drawImage(i.$canvasRenderBuffer.surface,0,0,r,a,0,0,r,a),(i.x||i.y)&&(i.dirtyRender&&i.$canvasRenderBuffer.context.translate(i.x,i.y),n.transform(1,0,0,1,-i.x,-i.y)),i.dirtyRender=!1))},o.renderGraphics=function(i,n,r){var a=i.width,s=i.height;0>=a||0>=s||(i.$canvasRenderBuffer&&i.$canvasRenderBuffer.context?i.dirtyRender&&i.$canvasRenderBuffer.resize(a,s,!0):(i.$canvasRenderer=new e.CanvasRenderer,i.$canvasRenderBuffer=new t.CanvasRenderBuffer(a,s)),i.$canvasRenderBuffer.context&&((i.x||i.y)&&(i.dirtyRender&&i.$canvasRenderBuffer.context.translate(-i.x,-i.y),n.transform(1,0,0,1,i.x,i.y)),i.dirtyRender&&(t.WebGLUtils.deleteWebGLTexture(i.$canvasRenderBuffer.surface),i.$canvasRenderer.renderGraphics(i,i.$canvasRenderBuffer.context,r)),n.drawImage(i.$canvasRenderBuffer.surface,0,0,a,s,0,0,a,s),(i.x||i.y)&&(i.dirtyRender&&i.$canvasRenderBuffer.context.translate(i.x,i.y),n.transform(1,0,0,1,-i.x,-i.y)),i.dirtyRender=!1))},o.renderGroup=function(e,t){for(var i=e.drawData,n=i.length,r=0;n>r;r++){var a=i[r];this.renderNode(a,t)}},o.createRenderBuffer=function(e,i){var n=r.pop();return n?n.resize(e,i,!0):(n=new t.WebGLRenderBuffer(e,i),n.$computeDrawCall=!1),n},a}();t.WebGLRenderer=a,e.registerClass(a,"egret.web.WebGLRenderer",["egret.sys.SystemRenderer"])}(t=e.web||(e.web={}))}(egret||(egret={}));